<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Enterprise Risk</title>
    <script type="module">
      // Vite React Fast Refresh preamble (dev-only)
      import { injectIntoGlobalHook } from "/@react-refresh";
      injectIntoGlobalHook(window);
      window.$RefreshReg$ = () => {};
      window.$RefreshSig$ = () => (type) => type;
    </script>
    <script type="module" src="/@vite/client"></script>
    <style>
      html,body,#root{height:100%} body{margin:0;font-family:Inter,system-ui,Arial,sans-serif;background:#fff}
      #boot{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;color:#334155}
      #boot .msg{padding:12px 16px;border:1px solid #e2e8f0;border-radius:8px;background:#f8fafc}
      #boot .err{color:#b91c1c;background:#fef2f2;border-color:#fecaca;max-width:80ch;white-space:pre-wrap}
    </style>
  </head>
  <body>
    <div id="root"><div id="boot"><div class="msg">Loading appâ€¦</div></div></div>

    <!-- One, single, definitive boot path: dynamic import with UI error if it fails -->
    <script type="module">
      const bootEl = document.getElementById('boot');
      const showErr = (e) => {
        const root = document.getElementById('root');
        const msg = String(e?.stack || e?.message || e);
        root.innerHTML = `<div id="boot"><div class="msg err"><strong>Boot error</strong>\n${msg}</div></div>`;
        console.error('[boot-error]', e);
      };

      try {
        // Bust cache to avoid 304-stale scenarios in dev
        const qs = `?t=${Date.now()}`;
        await import(`/src/main.tsx${qs}`);
        if (bootEl) bootEl.remove();
        console.log('[boot] main.tsx imported');
      } catch (e) {
        showErr(e);
      }
    </script>
  </body>
</html>
